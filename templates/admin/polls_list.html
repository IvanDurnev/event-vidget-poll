<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Опросы</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 30px;
            max-width: 800px;
        }
        .poll {
            padding: 12px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .active {
            background: #e6f7e6;
        }
        button {
            padding: 6px 10px;
        }
        .badge {
            font-weight: bold;
            color: green;
        }
    </style>
</head>
<body>

<h1>Список опросов</h1>

<p>
    <a href="/admin/poll/create">+ Создать новый опрос</a>
</p>

{% for poll in polls %}
    <div class="poll {% if poll.id == active_poll_id %}active{% endif %}">
        <div>
            <strong>{{ poll.question }}</strong>
            {% if poll.id == active_poll_id %}
                <span class="badge">— активен</span>
            {% endif %}
        </div>

        <div>
            {% if poll.id == active_poll_id %}
                <form method="post" action="/admin/poll/deactivate" style="display:inline">
                    <button type="submit">Деактивировать</button>
                </form>
            {% else %}
                <form method="post" action="/admin/poll/{{ poll.id }}/activate" style="display:inline">
                    <button type="submit">Активировать</button>
                </form>
            {% endif %}
            <form
                method="post"
                action="/admin/poll/{{ poll.id }}/clear"
                style="display:inline"
                onsubmit="return confirmClear('{{ poll.question }}')"
            >
                <button type="submit" style="margin-left:10px;color:red;">
                    Удалить все ответы
                </button>
            </form>
        </div>
    </div>
{% endfor %}

</body>
</html>

<script>
    function confirmClear(question) {
        return confirm(
            "Вы уверены, что хотите удалить ВСЕ ответы для опроса:\n\n" +
            question +
            "\n\nЭто действие нельзя отменить."
        );
    }
</script>
